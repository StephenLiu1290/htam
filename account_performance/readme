core calculation for account performance, it depends on helper functions.
